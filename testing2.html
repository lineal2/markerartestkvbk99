<!doctype html>
<html lang="en">

<head>
    <title>Quuppa Tag monitor 3D</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">


<body>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/110/three.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/3.1.0/three.js/build/ar.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.115/examples/js/loaders/GLTFLoader.js"></script>
    

    <script type="module">

        //import * as  THREE from './three/build/three.module.js'
	//	import {OrbitControls} from './three/examples/jsm/controls/OrbitControls.js'
	//	import {TrackballControls} from './three/examples/jsm/controls/TrackballControls.js'
		//import {ARController} from 'https://raw.githack.com/AR-js-org/AR.js/3.1.0/three.js/build/ar.js'

      const renderer = new THREE.WebGLRenderer({
        antialias: true,
        alpha: true
      });
      renderer.setClearColor(new THREE.Color(), 0);
      renderer.setSize(640, 480);
      renderer.domElement.style.position = 'absolute';
      renderer.domElement.style.top = '0px';
      renderer.domElement.style.left = '0px';
      document.body.appendChild(renderer.domElement);

      const scene = new THREE.Scene();
      scene.visible = false;
      const camera = new THREE.Camera();
      scene.add(camera);

      const arToolkitSource = new THREEx.ArToolkitSource({
        sourceType: 'webcam'
      });

      arToolkitSource.init(() => {
        setTimeout(() => {
          onResize();
        }, 2000);
      });

      addEventListener('resize', () => {
        onResize();
      });

      function onResize() {
        arToolkitSource.onResizeElement();
        arToolkitSource.copyElementSizeTo(renderer.domElement);
        if (arToolkitContext.arController !== null) {
          arToolkitSource.copyElementSizeTo(arToolkitContext.arController.canvas);
        }
      };

      const arToolkitContext = new THREEx.ArToolkitContext({
        cameraParametersUrl: 'data/camera_para.dat',
        detectionMode: 'mono'
      });

      arToolkitContext.init(() => {
        camera.projectionMatrix.copy(arToolkitContext.getProjectionMatrix());
      });

      const marker = new THREE.Group();
scene.add(marker);
const arMarkerControls = new THREEx.ArMarkerControls(arToolkitContext, marker, {
  type: 'pattern',
  patternUrl: 'patterns/warn.patt',
  changeMatrixMode: 'modelViewMatrix'
});

var texture = THREE.ImageUtils.loadTexture( 'https://lineal2.github.io/markerartestkvbk99/configDiagram.png' );
const maxAnisotropy = renderer.capabilities.getMaxAnisotropy();
texture.anisotropy = maxAnisotropy;

				var material = new THREE.MeshBasicMaterial( { map: texture } );



    // plane
    var plane = new THREE.Mesh(new THREE.PlaneGeometry(4, 4),material);
    plane.overdraw = true;
    marker.add(plane);





const marker2 = new THREE.Group();
scene.add(marker2);
const arMarkerControls2 = new THREEx.ArMarkerControls(arToolkitContext, marker2, {
  type: 'pattern',
  patternUrl: 'patterns/words.patt',
  changeMatrixMode: 'modelViewMatrix'
});

const markerPlane = new THREE.Mesh(
        new THREE.PlaneBufferGeometry(1, 1),
        new THREE.MeshBasicMaterial({
          colorWrite: false,
          depthWrite: false,
        })
      );
      markerPlane.rotation.x = -0.5 * Math.PI;
      marker2.add(markerPlane);

      const gltfLoader = new THREE.GLTFLoader();
  const url = '3djseeq.gltf';
  gltfLoader.load(url, (gltf) => {
    const root = gltf.scene;
    marker2.add(root);
});

      const loader = new THREE.FontLoader();
      loader.load('data/testfont.json', (font) => {
        const textGeom = new THREE.TextBufferGeometry('Quuppa Test', {
            font: font,
            size: 0.1,
            height: 0.04,
          });
        textGeom.center();
        const text = new THREE.Mesh(
          textGeom,
          new THREE.MeshNormalMaterial()
        );
        text.position.set(0, 0.75, 0);
        marker2.add(text);



        const marker3 = new THREE.Group();
scene.add(marker3);
const arMarkerControls3 = new THREEx.ArMarkerControls(arToolkitContext, marker3, {
  type: 'pattern',
  patternUrl: 'patterns/warn2.patt',
  changeMatrixMode: 'modelViewMatrix'
});


            // Creating the Cube, we can change the parameters passed to modify the size of cube :)
            var geometry = new THREE.BoxGeometry(2.5,2,2);
            
            // Add six images to the material array to wrap different image on different faces     
            var materialArray = [
           new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load('https://lineal2.github.io/markerartestkvbk99/imageOne.jpg'), side: THREE.DoubleSide}), // RIGHT SIDE
           new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load('https://lineal2.github.io/markerartestkvbk99/imageTwo.png') , side: THREE.DoubleSide}), // RIGHT SIDE;
           new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load('https://lineal2.github.io/markerartestkvbk99/imageThree.png') , side: THREE.DoubleSide}), // RIGHT SIDE;
           new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load('https://lineal2.github.io/markerartestkvbk99/imageFour.png') , side: THREE.DoubleSide}), // RIGHT SIDE;
           new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load('https://lineal2.github.io/markerartestkvbk99/imageFive.jpg') , side: THREE.DoubleSide}), // RIGHT SIDE;
           new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load('https://lineal2.github.io/markerartestkvbk99/imageSix.jpg') , side: THREE.DoubleSide}), // RIGHT SIDE;
           ];
            var material = new THREE.MeshFaceMaterial(materialArray);
            
            // Finally Creating the Cube Mesh, wrapping images on its surface
            var cube = new THREE.Mesh(geometry, material);
            // Adding the cube to scene
            marker3.add(cube);
      });

      requestAnimationFrame(function animate(){
        requestAnimationFrame(animate);
        if (arToolkitSource.ready) {
          arToolkitContext.update(arToolkitSource.domElement);
          scene.visible = camera.visible;
        }

        renderer.render(scene, camera);
      });
    </script>






</body>

</html>
